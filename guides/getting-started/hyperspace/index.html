


<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Hypercore Protocol</title>

    <!-- SEO -->
    <meta name="Description" content="A fast, scalable, and secure peer-to-peer protocol for everyone.">
    <meta name="keywords" content="decentralization,hypercore,peer-to-peer,p2p,hyperdrive">

    <!-- Social -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@HypercoreProto">
    <meta name="twitter:creator" content="@HypercoreProto">
    <meta name="og:title" content="Hypercore Protocol">
    <meta name="og:description" content="A fast, scalable, and secure peer-to-peer protocol for everyone.">
    <meta name="twitter:image" content="https://hypercore-protocol.org/images/hypercore-protocol.png">

    
      
        <link rel="stylesheet" type="text/css" href="../../../css/layouts/guides.css">
      
    
    <link rel="stylesheet" type="text/css" href="../../../fonts/index.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  </head>
  <body class="wide">
    <header class="desktop">
      <div class="nav-left">
        <a href="../../../" title="Home"><img class="logo" src="../../../images/hypercore-protocol.png"></a>
        <a class="current" href="../../../guides" title="Guides">Guides</a>
        <a class="" href="../../../protocol" title="Protocol">Protocol</a>
        <a class="" href="../../../install" title="Install">Install</a>
        <a class="" href="../../../awesome-hacks" title="Awesome Hacks">Awesome Hacks</a>
      </div>
      <div class="nav-right">
        <a href="https://chat.hypercore-protocol.org" title="Hypercore Discord Server"><img class="icon" src="../../../images/discord-icon.webp"></a>
        <a href="https://twitter.com/hypercoreproto" title="Hypercore Twitter"><img class="icon" src="../../../images/twitter-icon.png"></a>
        <a href="https://github.com/hypercore-protocol" title="Hypercore GitHub Org"><img class="icon" src="../../../images/github-icon.png"></a>
      </div>
    </header>
    <header class="mobile">
      <a href="../../../" title="Home"><img class="logo" src="../../../images/hypercore-protocol.png"></a>
      <a id="mobile-menu-btn" href="#" title="Nav"><img class="menu" src="../../../images/icons8/menu-26.png"></a>
    </header>
    <div id="mobile-menu">
      <a class="current" href="../../../" title="Home">Home</a>
      <a class="current" href="../../../guides" title="Guides">Guides</a>
      <a class="" href="../../../protocol" title="Protocol">Protocol</a>
      <a class="" href="../../../install" title="Install">Install</a>
      <a class="" href="../../../awesome-hacks" title="Awesome Hacks">Awesome Hacks</a>
    </div>

    


<main>
  <div class="guides-breadcrumbs">
    
    <a href="../../../guides/" title="Guides">Guides</a>
  <span>&rsaquo;</span>
    <a href="../../../guides/getting-started/" title="Getting Started">Getting Started</a>
  <span>&rsaquo;</span>
    <a href="../../../guides/getting-started/hyperspace/" title="Using Hyperspace">Using Hyperspace</a>
  
  </div>
  <div class="guides-layout">
    <nav>
      
    <ul>
      
    <li>
      <a class="child-current" href="../../../guides/getting-started/" title="Getting Started">Getting Started</a>
      
    <ul>
      
    <li>
      <a class="current" href="../../../guides/getting-started/hyperspace/" title="Using Hyperspace">Using Hyperspace</a>
      
    </li>
  

    <li>
      <a class="" href="../../../guides/getting-started/standalone-modules/" title="Using Standalone Modules">Using Standalone Modules</a>
      
    </li>
  
    </ul>
  
    </li>
  

    <li>
      <a class="" href="../../../guides/hyp/" title="Hyp CLI">Hyp CLI</a>
      
    </li>
  

    <li>
      <a class="" href="../../../guides/hyperspace/" title="Hyperspace API">Hyperspace API</a>
      
    </li>
  

    <li>
      <a class="" href="../../../guides/modules/" title="Modules">Modules</a>
      
    </li>
  

    <li>
      <a class="" href="../../../guides/walkthroughs/" title="Walkthroughs">Walkthroughs</a>
      
    </li>
  

    <li>
      <a class="" href="../../../guides/workshops/" title="Workshops">Workshops</a>
      
    </li>
  

    <li>
      <a class="" href="../../../guides/faq/" title="FAQ">FAQ</a>
      
    </li>
  
    </ul>
  
    </nav>
    <div class="guide-content">
      <h1><img src="../../../images/icons8/program-50.png"> Getting Started With Hyperspace</h1>
<p>Hyperspace is a server that bundles together many of our core modules, handling many low-level details for you. It's intended to be a configuration-less, opinionated take on the Hypercore Protocol stack, with a handful of extra features to make things easy to use.</p>
<p>Hyperspace handles P2P connectivity, Hypercore garbage collection, and storage management. It and exposes an RPC interface that's used to power <a href="../../hyperspace/hypercore/" title="RemoteHypercore">RemoteHypercore</a>, <a href="../../hyperspace/corestore/" title="RemoteCorestore">RemoteCorestore</a>, and <a href="../../hyperspace/networker/" title="RemoteNetworker">RemoteNetworker</a> APIs.</p>
<p>A <code>RemoteHypercore</code> can generally be viewed as a drop-in replacement for a regular Hypercore, and a <code>RemoteNetworker</code> mirrors the <a href="https://github.com/hypercore-protocol/corestore-networker" class="external" title="Corestore Networker">@corestore/networker</a> API.</p>
<h2>Installation</h2>
<p>There are three ways to get started with Hyperspace:</p>
<ol>
<li><a href="../../hyp/">Hyp CLI</a>: The <code>hyp</code> CLI tool will internally spawn and communicate with a Hyperspace instance.</li>
<li>Standalone: <code>npm i hyperspace -g</code> gives you a <code>hyperspace</code> command that can be used to start a server.</li>
<li>Programmatically: The <code>hyperspace</code> module exports a <code>Server</code> class.</li>
</ol>
<p>While we recommend using the Hyp CLI in most cases, this walkthrough will show you how to programmatically work with Hyperspace servers and clients.</p>
<h2>Walkthrough</h2>
<p>If you want to follow along with the code, setup the walkthrough repo:</p>
<pre class="language-bash"><code class="language-bash"><span class="token function">git</span> clone https://github.com/andrewosh/hypercore-protocol-walkthroughs.git<br><span class="token builtin class-name">cd</span> hypercore-protocol-walkthroughs/hyperspace<br><span class="token function">npm</span> <span class="token function">install</span></code></pre>
<p>This walkthrough has a single dependency, <code>hyperspace</code> (not including <code>chalk</code>, for making CLI output pretty), which exports both the client and the server.</p>
<h2>Step 1: Starting Two Hyperspace Servers</h2>
<p>Let's create two Hyperspace servers, one simulating our local instance, and one simulating a remote peer:</p>
<pre class="language-js"><code class="language-js"><span class="token comment">// Create one server to simulate your local Hyperspace instance.</span><br><span class="token keyword">const</span> localServer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HyperspaceServer</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>  storage<span class="token operator">:</span> <span class="token string">'./storage/hyperspace-storage-1'</span><span class="token punctuation">,</span><br>  host<span class="token operator">:</span> <span class="token string">'hyperspace-demo-1'</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><br><span class="token comment">// Create a second server to simulate a remote peer.</span><br><span class="token keyword">const</span> remoteServer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HyperspaceServer</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>  storage<span class="token operator">:</span> <span class="token string">'./storage/hyperspace-storage-2'</span><span class="token punctuation">,</span><br>  host<span class="token operator">:</span> <span class="token string">'hyperspace-demo-2'</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><br><span class="token keyword">await</span> localServer<span class="token punctuation">.</span><span class="token function">ready</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><span class="token keyword">await</span> remoteServer<span class="token punctuation">.</span><span class="token function">ready</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p>The <code>storage</code> option defines where Hypercores will be stored on disk. By default, they will be saved to <code>~/.hyperspace/storage</code>. The <code>host</code> option is more nuanced, and is described below.</p>
<p>A Hyperspace server emits a handful of events. These are useful for debugging, so let log a few of these to see when clients to the daemon connect and disconnect:</p>
<pre class="language-js"><code class="language-js">localServer<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'client-open'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token comment">// Our program has connected to the daemon</span><br>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>chalk<span class="token punctuation">.</span><span class="token function">green</span><span class="token punctuation">(</span><span class="token string">'(local) A HyperspaceClient has connected'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><br>localServer<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'client-close'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token comment">// Our program has disconnected from the daemon</span><br>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>chalk<span class="token punctuation">.</span><span class="token function">green</span><span class="token punctuation">(</span><span class="token string">'(local) A HyperspaceClient has disconnected'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
<p>Run this step (<a href="https://github.com/hypercore-protocol/hypercore-protocol-walkthroughs/blob/main/hyperspace/1-start-servers.js" class="external" title="full code">full code</a>):</p>
<pre class="language-bash"><code class="language-bash">node <span class="token number">1</span>-start-servers.js</code></pre>
<p>Now that both daemons are running, let's simulate a Hypercore replication in Step 2.</p>
<div class="info-aside" markdown="1">
<h4><img src="../../../images/icons8/info-24.png"> Hosts and Ports</h4>
<p>By default, Hyperspace serves its RPC interface over a UNIX domain socket on Linux/OSX and a named pipe on Windows. You can configure the name of the domain socket with the <code>host</code> option, or with the <code>HYPERSPACE_SOCKET</code> environment variable.</p>
<p>If both <code>host</code> and <code>port</code> options are provided, it will instead bind to a TCP server. Importantly, Hyperspace does not provide any authentication or encryption over these connections, as they're expected to be local. If you want to accept remote connections, you'll need to add a separate auth layer, and nothing is provided out of the box.</p>
</div>
<h2>Step 2: Replicate RemoteHypercores</h2>
<p>We'll create two Hyperspace clients, one for each server we started in Step 1:</p>
<pre class="language-js"><code class="language-js"><span class="token comment">// Create a client that's connected to the "local" peer.</span><br><span class="token keyword">const</span> localClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HyperspaceClient</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>  host<span class="token operator">:</span> <span class="token string">'hyperspace-demo-1'</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><br><br><span class="token comment">// Create a client that's connected to the "remote" peer.</span><br><span class="token keyword">const</span> remoteClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HyperspaceClient</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>  host<span class="token operator">:</span> <span class="token string">'hyperspace-demo-2'</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
<p>Now on the &quot;local&quot; peer, let's create a new <a href="../../hyperspace/hypercore/">RemoteHypercore</a> and append a few blocks. Since RemoteHypercore mirrors the Hypercore API, they can be used interchangably.</p>
<pre class="language-js"><code class="language-js"><span class="token comment">// Create a new RemoteCorestore.</span><br><span class="token keyword">const</span> localStore <span class="token operator">=</span> localClient<span class="token punctuation">.</span><span class="token function">corestore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><br><span class="token comment">// Create a fresh Remotehypercore.</span><br><span class="token keyword">const</span> localCore <span class="token operator">=</span> localStore<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>  valueEncoding<span class="token operator">:</span> <span class="token string">'utf-8'</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><br><br><span class="token comment">// Append two blocks to the RemoteHypercore.</span><br><span class="token keyword">await</span> localCore<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'hello'</span><span class="token punctuation">,</span> <span class="token string">'world'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre>
<p>To create a RemoteHypercore, we first need to create a <a href="../../hyperspace/corestore/">RemoteCorestore</a> instance. A Corestore can be viewed as a Hypercore factory — it provides a <code>get</code> method for creating or instantiating Hypercores.</p>
<p>Now we want to make this new Hypercore available to the Hyperswarm network. We'll use the <code>replicate</code> function:</p>
<pre class="language-js"><code class="language-js"><span class="token comment">// Start seeding the Hypercore on the Hyperswarm network.</span><br>localClient<span class="token punctuation">.</span><span class="token function">replicate</span><span class="token punctuation">(</span>localCore<span class="token punctuation">)</span></code></pre>
<p>We'll also log whenever the Hypercore connects to new peers:</p>
<pre class="language-js"><code class="language-js"><span class="token comment">// Log when the core has any new peers.</span><br>localCore<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'peer-add'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>chalk<span class="token punctuation">.</span><span class="token function">blue</span><span class="token punctuation">(</span><span class="token string">'(local) Replicating with a new peer.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
<div class="info-aside" markdown="1">
<h4><img src="../../../images/icons8/info-24.png"> Hyperspace Networking</h4>
<p>Hyperswarm provides two configuration options for interacting with its DHT, <strong><code>announce</code></strong> and <strong><code>lookup</code></strong>. When you announce a discovery key, you advertise to the DHT that you're in possession of the corresponding Hypercore.</p>
<p>A lookup, on the other hand, will not insert new entries into the DHT, it will only query the DHT to discover other peers announcing that discovery key.</p>
<p>In many cases, you just want to make a RemoteHypercore available to the network without worrying about the specifics. The Hyperspace client's <code>replicate</code> function is effectively sugaring around</p>
<pre class="language-js"><code class="language-js">client<span class="token punctuation">.</span>network<span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span>core<span class="token punctuation">.</span>discoveryKey<span class="token punctuation">,</span> <span class="token punctuation">{</span> announce<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> lookup<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
</div>
<h3>Connect the Two Cores</h3>
<p>Our RemoteHypercore now contains two blocks and is being announced on the Hyperswarm DHT. It's time to create a RemoteHypercore on the second Hyperspace instance, which is simulating a remote peer.</p>
<p>To do this, we'll duplicate the exact same steps as above, with one difference: we'll instantiate the second RemoteHypercore with the first core's key:</p>
<pre class="language-js"><code class="language-js"><span class="token comment">// Create a fresh Remotehypercore.</span><br><span class="token comment">// Here we'll get a core using the shared key from above.</span><br><span class="token keyword">const</span> clone <span class="token operator">=</span> remoteStore<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>  key<span class="token operator">:</span> localCore<span class="token punctuation">.</span>key<span class="token punctuation">,</span><br>  valueEncoding<span class="token operator">:</span> <span class="token string">'utf-8'</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
<p>After an identical <code>replicate</code> step on the <code>remoteClient</code>, the two Hypercores will be connected:</p>
<pre class="language-js"><code class="language-js"><span class="token comment">// Start seeding the clone (this will connect to the first Hyperspace instance)</span><br>remoteClient<span class="token punctuation">.</span><span class="token function">replicate</span><span class="token punctuation">(</span>clone<span class="token punctuation">)</span></code></pre>
<p>And finally the remote peer can read out the first two blocks:</p>
<pre class="language-js"><code class="language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>chalk<span class="token punctuation">.</span><span class="token function">green</span><span class="token punctuation">(</span><span class="token string">'First two blocks of the clone:'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><br>  <span class="token keyword">await</span> clone<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token keyword">await</span> clone<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><br><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>
<p>Run this step (<a href="https://github.com/hypercore-protocol/hypercore-protocol-walkthroughs/blob/main/hyperspace/2-replicate-hypercores.js" class="external" title="full code">full code</a>):</p>
<pre class="language-bash"><code class="language-bash">node <span class="token number">2</span>-replicate-hypercores.js</code></pre>
<style>
  h1 img {
    width: 40px;
    position: relative;
    top: 6px;
  }

  h4 img {
    position: relative;
    top: 5px;
    margin-right: 5px;
  }
</style>
    </div>
  </div>
</main>

    <footer>
      <div class="patreon-cta">
        <div class="patreon-cta-inner">
          <img src="../../../images/icons8/heart-24-inverted.png">
          Hypercore Protocol is open-source!
          <a href="https://www.patreon.com/paul_maf_and_andrew" title="Patreon" target="_blank">Support us on Patreon</a>.
        </div>
      </div>
      <div class="footer-inner">
        <div class="footer-linklists">
          <div>
            <h5>Site</h5>
            <div><a href="../../../" title="Home">Home</a></div>
            <div><a href="../../../guides/" title="Guides">Guides</a></div>
            <div><a href="../../../protocol/" title="Protocol">Protocol</a></div>
            <div><a href="../../../install/" title="Install">Install</a></div>
          </div>
          <div>
            <h5>Repos</h5>
            <div><a href="https://github.com/hypercore-protocol/hyperspace" title="Hyperspace">Hyperspace</a></div>
            <div><a href="https://github.com/hypercore-protocol/cli" title="Hyp CLI">Hyp CLI</a></div>
            <div><a href="https://github.com/hypercore-protocol/hypercore" title="Hypercore">Hypercore</a></div>
            <div><a href="https://github.com/hypercore-protocol/hyperdrive" title="Hyperdrive">Hyperdrive</a></div>
            <div><a href="https://github.com/hypercore-protocol/hyperbee" title="Hyperbee">Hyperbee</a></div>
            <div><a href="https://github.com/hyperswarm/" title="Hyperswarm">Hyperswarm</a></div>
          </div>
          <div>
            <h5>Links</h5>
            <div><a href="https://blog.hypercore-protocol.org" title="Blog">Blog</a></div>
            <div><a href="https://github.com/hypercore-protocol" title="GitHub">GitHub</a></div>
            <div><a href="https://twitter.com/hypercoreproto" title="Twitter">Twitter</a></div>
            <div><a href="https://chat.hypercore-protocol.org" title="Discord Chat">Discord Chat</a></div>
          </div>
        </div>
        <div class="copyrights">
          Icons by <a href="https://icons8.com" title="Icons8">Icons8</a>
        </div>
      </div>
    </footer>
    <script src="../../../js/mobile-nav.js"></script>
    <script async defer src="https://scripts.simpleanalyticscdn.com/latest.js"></script>
    <noscript><img src="https://queue.simpleanalyticscdn.com/noscript.gif" alt=""></noscript>
  </body>
</html>
